#! /usr/bin/env python
# -*- coding: utf-8 -*-

import optparse
import sys
import os
import pbs

from os import environ, path

"""
Import lib
"""
sys.path.append(sys.path[0] + '/..')

from lib.motes import MotesInstaller, Motes, CommandLogger, CommandError

"""
Require minimum Python version
"""
if sys.version_info < (2, 7):
  CommandError('Wrong Python Version!\n  >= 2.7 is required.').exe()

"""
Default init
"""
if __name__ == '__main__':
  usage = 'Usage: %prog [command] [options]'

  parser = optparse.OptionParser(usage, prog='Motes', version='%prog version 0.1')

  parser.add_option('-p', '--path', action='store_true', help='prints motes folder path')
  parser.add_option('-k', '--kitten', action='store_true', help='show me a kitten')

  (options, arguments) = parser.parse_args()

  try:
    mi = MotesInstaller(path.abspath(path.dirname(__file__)))

    if not mi.installed():
      mi.install()

    if options.path:
      CommandLogger('Motes home directory: \n', True)
      CommandLogger(mi.path)

    elif options.kitten:
      pbs.open('http://placekitten.com/800/600')

    else:
      if len(arguments) < 1:
        CommandLogger('Insufficient arguments given.', True)

        sys.exit()

      else: 
        m = Motes(mi.path, arguments[0], arguments[1::])
  except KeyboardInterrupt:
    print ""

    pass
